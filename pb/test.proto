syntax = "proto3";

package pb;

import "github.com/rms1000watt/degeneres/pb/address.proto";

option (dg.rpc_to_endpoints) = true;
option (dg.project_name) = "DegeneresTest";
option (dg.author) = "Ryan Smith";

service BallparkAPI {
    option (dg.middleware.cors) = "localhost,127.0.0.1,www.example.com";

    rpc Person(PersonIn) returns (PersonOut) {
        option (dg.middleware.no_cache) = true;
        option (dg.method) = "GET";
        option (dg.method) = "POST";
    }

    rpc Ticket(TicketIn) returns (TicketOut) {
        option (dg.middleware.no_cache) = true;
        option (dg.method) = "GET";
        option (dg.method) = "POST";
    }

    rpc Management(ManagementIn) returns (ManagementOut) {}
}

message PersonIn {
    int64 id          = 1;
    string first_name = 2 [(dg.validate) = "maxLength=100", (dg.transform) = "truncate=50"];
    string last_name  = 3 [(dg.validate) = "maxLength=1000,required,minLength=1", (dg.transform) = "truncate=50,hash"];
}

message PersonOut {
    string first_name       = 1;
    string last_name        = 2;
    address.Address address = 3;
}

message TicketIn {
    string id = 1;
}

message TicketOut {
    string row  = 1;
    string seat = 2;
}

message ManagementIn {
    bool power = 1;
}

message ManagementOut {
    bool success = 1;
}
